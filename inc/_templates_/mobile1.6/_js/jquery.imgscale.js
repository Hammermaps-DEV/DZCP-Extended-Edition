(function(e){e.fn.imgscale=function(t){function l(e,l,c,h,p){function d(){if(r>n)v("w");else if(r<n)v("t");else if(r==n)v("s")}function v(e){if(s>i)m(e,"w");else if(s<i)m(e,"t");else if(s==i)m(e,"s")}function m(e,t){if(e=="w"&&t=="w")g();else if(e=="w"&&t=="t")y("w");else if(e=="w"&&t=="s")y("w");else if(e=="t"&&t=="w")y("w");else if(e=="t"&&t=="t")g();else if(e=="t"&&t=="s")y("t");else if(e=="s"&&t=="w")y("t");else if(e=="s"&&t=="t")y("w");else if(e=="s"&&t=="s")y("w")}function g(){if(s*n/s>=r)y("t");else y("w")}function y(i){switch(i){case"t":if(t.scale=="fit")e.attr("width",r);else e.attr("height",n);break;case"w":if(t.scale=="fit")e.attr("height",n);else e.attr("width",r);break}if(t.center)b();else w()}function b(){o=e.width();u=e.height();if(u>n){f="-"+Math.floor((u-n)/2)+"px";e.css("margin-top",f)}if(o>r){a="-"+Math.floor((o-r)/2)+"px";e.css("margin-left",a)}w()}function w(){if(t.fade>0&&c)l.animate({opacity:1},t.fade);else l.css("opacity",1)}n=!p?l.height():p;r=!h?l.width():h;i=e.height();s=e.width();d()}t=e.extend({parent:false,scale:"fill",center:true,fade:0,WidthPX:false,HeightPX:false},t);var n,r,i,s,o,u,a,f;this.each(function(){var n=e(this);var r=!t.parent?n.parent():n.parents(t.parent);r.css({opacity:0,overflow:"hidden"});if(r.length>0){n.removeAttr("height").removeAttr("width");if(this.complete){l(n,r,false,t.WidthPX,t.HeightPX)}else{n.load(function(){l(n,r,true,t.WidthPX,t.HeightPX)})}}})}})(jQuery)